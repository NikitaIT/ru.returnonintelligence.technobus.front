function getLanguage(e){$.getJSON("lang/"+e+".json",function(e){$.each(e,function(e,t){$("[name = "+e+"]").html(t)})})}$(window).load(function(){$(".preloader").delay(1e3).fadeOut("slow")});var days=["sunday","monday","tuesday","tednesday","thursday","friday","saturday"],fullDays=["fullSunday","fullMonday","fullTuesday","fullTednesday","fullThursday","fullFriday","fullSaturday"];$(function(){$(".russian").button("toggle"),$(".russian").click(function(){getLanguage("ru"),$("#map").attr("lang","ru")}),$(".russian").click(),$(".english").click(function(){getLanguage("en"),$("#map").attr("lang","en")}),$(".lang").addClass("btn-group-vertical"),$(".lang").removeClass("btn-group"),$(".to_technopolis").button("toggle"),$(".to_technopolis").click(function(){$("#route0").css("visibility","visible"),$("#route0").css("position","initial"),$("#route1").css("visibility","hidden"),$("#route1").css("position","absolute")}),$(".from_technopolis").click(function(){$("#route0").css("visibility","hidden"),$("#route0").css("position","absolute"),$("#route1").css("visibility","visible"),$("#route1").css("position","initial")})}),$(function(){function e(){var e={hour:"numeric",minute:"numeric"},t=new Date,o=t.toLocaleString("ru",e)+" ",n=function(e){return fullDays[e.getDay()]}(t);$(".day").attr("name",n),$("time.current-time").html(o),Number.prototype.div=function(e){return(this-this%e)/e};var a=t.getMinutes(),i=a>=10?a.div(10)+1+"0":"10";$(".timetable__min:contains("+t.getHours()+":"+i+")").css("border","2px solid green")}!function(){var e="";days.forEach(function(t,o,n){e+='<div class="panel--button panel--button-'+o+" day-"+t+' "><span name="'+t+'"></span></div>'}),$(".panel").append(e)}(),e(),setInterval(e,9e3)}),$(function(){function e(){function e(e,t){ymaps.route([{point:e,type:"viaPoint"},t]).then(function(e){i.geoObjects.add(s=e)},function(e){})}function t(){r.isSelected()&&(s&&i.geoObjects.remove(s),e(n,a))}var o={metro:[59.853876,30.321102],technopolis:[59.818043,30.327938],metro1:[59.850127,30.321772],routeCenter:[59.835681,30.322253]},n=o.metro,a=o.technopolis,i=new ymaps.Map("map",{center:o.metro,zoom:16},{searchControlProvider:"yandex#search"}),l=new ymaps.Placemark(i.getCenter());i.geoObjects.add(l);var s,r=new ymaps.control.Button('<i class="fa fa-bus" style="color: dimgray"></i>');r.events.add("select",function(){e(n,a),i.setZoom(12),i.setCenter(o.routeCenter)}).add("deselect",function(){s&&i.geoObjects.remove(s)}),i.controls.add(r,{float:"left",maxWidth:"auto"}),l.events.add("mouseenter",function(e){e.get("target").options.set("preset","islands#greenIcon")}).add("mouseleave",function(e){e.get("target").options.unset("preset")}),$(".from_technopolis").click(function(){i.setCenter(o.technopolis),l.geometry.setCoordinates(i.getCenter()),n=o.technopolis,a=o.metro1,t(),i.setZoom(16)}),$(".to_technopolis").click(function(){i.setCenter(o.metro),l.geometry.setCoordinates(i.getCenter()),n=o.metro,a=o.technopolis,t(),i.setZoom(16)})}ymaps.ready(e)}),$(function(){function e(){var e="https://docs.google.com/spreadsheet/pub?key=1VwgzSFxVRu2Z-9tvF8wimO2m3BmuW4ngcST5uGSRYRg&output=html",t=new GoogleSpreadsheet;t.url(e),t.load(function(e){localStorage.setItem(0,JSON.stringify(e)),o(JSON.parse(localStorage.getItem(0)),".timetable__row__all",0)});var t=new GoogleSpreadsheet;t.url(e+"&gid=1453141125"),t.load(function(e){localStorage.setItem(1,JSON.stringify(e)),o(JSON.parse(localStorage.getItem(1)),".timetable__row__all",1)}),localStorage.setItem("DATE",Date())}function t(e,t){var o="";e.items.forEach(function(e,t,n){o+='<p class="info-list--elem"><span class="info-list--elem__title">'+e.id+"</span>  "+e.info+"</p>"}),$(t).append(o)}function o(e,t,o){function n(e){var t="";for(var o in e)void 0!==i[o]&&(t+='<div  class="timetable__min '+function(e){var t=["Su","Mo","Tu","Te","Th","Fr","Sa","All"];if("All"===e){var o="";return days.forEach(function(e,t,n){o+=" day-"+e}),o+" day-All"}return void 0===t.indexOf(e)?(console.error("tableDayName is undefined")," "):" day-"+days[t.indexOf(e)]}(e[o])+'">'+e.id+":"+i[o]+"</div>");return t}console.log("f: addTableList(id="+o+")");var a="",i={b:"00",c:"05",d:10,e:15,f:20,g:25,h:30,i:35,j:40,k:45,l:50,m:55};a+='<div class="timetable__row__current" id="route'+o+'">',e.items.forEach(function(e,t,o){var i=n(e);""!==i&&(a+='<div class="timetable__row"><div class="timetable__hover ">'+e.id+'</div><hr class="line"/><div class="timetable__row--subrow">'+i+"</div></div>")}),a+="</div>",$(t).append(a)}var n=new GoogleSpreadsheet;if(0==localStorage.length||null==localStorage.getItem(0)||null==localStorage.getItem(1)?e():(function(){o(JSON.parse(localStorage.getItem(1)),".timetable__row__all",1),o(JSON.parse(localStorage.getItem(0)),".timetable__row__all",0)}(),navigator.onLine&&function(){$(".timetable__row__all").html(""),e()}()),navigator.onLine){var n=new GoogleSpreadsheet;n.url("https://docs.google.com/spreadsheet/pub?key=1VwgzSFxVRu2Z-9tvF8wimO2m3BmuW4ngcST5uGSRYRg&output=html&gid=135110459"),n.load(function(e){t(e,".info-list")})}getLanguage("ru")});